{"remainingRequest":"/home/lionel/Projects/vue_app/surkeys_website/node_modules/babel-loader/lib/index.js!/home/lionel/Projects/vue_app/surkeys_website/src/store/modules/user.js","dependencies":[{"path":"/home/lionel/Projects/vue_app/surkeys_website/src/store/modules/user.js","mtime":1577055339059},{"path":"/home/lionel/Projects/vue_app/surkeys_website/node_modules/cache-loader/dist/cjs.js","mtime":499162500000},{"path":"/home/lionel/Projects/vue_app/surkeys_website/node_modules/babel-loader/lib/index.js","mtime":499162500000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuZGF0ZS50by1zdHJpbmciOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy9lcy5vYmplY3QudG8tc3RyaW5nIjsKaW1wb3J0IGF4aW9zIGZyb20gImF4aW9zIjsKaW1wb3J0IGFwaSBmcm9tICIuLi8uLi9hcGkvc2VydmljZS5qcyI7CnZhciBzdGF0ZSA9IHsKICB0b2tlbnM6IHsKICAgIGFjY2Vzc190b2tlbjogbnVsbCwKICAgIGV4cGlyZXNfaW46IG51bGwsCiAgICByZWZyZXNoX3Rva2VuOiBudWxsLAogICAgdG9rZW5fdHlwZTogbnVsbAogIH0sCiAgY3VycmVudFVzZXI6IHt9Cn07CnZhciBhY3Rpb25zID0gewogIGxvZ2luOiBmdW5jdGlvbiBsb2dpbihjb250ZXh0LCB1c2VyKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICB2YXIgZGF0YSA9IHsKICAgICAgICAvLyBjbGllbnRfaWQ6IDIsCiAgICAgICAgLy8gY2xpZW50X3NlY3JldDogJ2RPandLdVJROURaQlNmcVZnYUlPdjVqSVdhZ3pRM2lOSmo3M2xUQ3onLAogICAgICAgIC8vIGdyYW50X3R5cGU6ICdwYXNzd29yZCcsCiAgICAgICAgZW1haWw6IHVzZXIuZW1haWwsCiAgICAgICAgcGFzc3dvcmQ6IHVzZXIucGFzc3dvcmQKICAgICAgfTsKICAgICAgY29uc29sZS5sb2coZGF0YSk7CiAgICAgIGF4aW9zLnBvc3QoJ2h0dHA6Ly8xMjcuMC4wLjE6ODAwMC9hcGkvbG9naW4nLCBkYXRhKS50aGVuKGZ1bmN0aW9uIChyZXNwb25zZSkgewogICAgICAgIHZhciByZXNwb25zZURhdGEgPSByZXNwb25zZS5kYXRhOwogICAgICAgIHZhciBub3cgPSBEYXRlLm5vdygpOwogICAgICAgIHJlc3BvbnNlRGF0YS5leHBpcmVzX2luID0gcmVzcG9uc2VEYXRhLmV4cGlyZXNfaW4gKyBub3c7CiAgICAgICAgY29uc29sZS5sb2cocmVzcG9uc2VEYXRhKTsKICAgICAgICBjb250ZXh0LmNvbW1pdCgndXBkYXRlVG9rZW5zJywgcmVzcG9uc2VEYXRhLnRva2VuKTsKICAgICAgICBsb2NhbFN0b3JhZ2Uuc2V0SXRlbSgnYWNjZXNzX3Rva2VuJywgcmVzcG9uc2VEYXRhLnRva2VuKTsKICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycikgewogICAgICAgIHJlamVjdChlcnIpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgZ2V0Q3VycmVudFVzZXI6IGZ1bmN0aW9uIGdldEN1cnJlbnRVc2VyKGNvbnRleHQpIHsKICAgIGNvbnNvbGUubG9nKCdnZXR0aW5nIGN1cnJlbnQgdXNlci4uLicpOwogICAgdmFyIHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc190b2tlbicpOwogICAgYXhpb3MuZGVmYXVsdHMuaGVhZGVycy5jb21tb25bJ0F1dGhvcml6YXRpb24nXSA9ICdCZWFyZXIgJyArIHRva2VuOwogICAgY29uc29sZS5sb2coJ2FjY2Vzc19pdGVtJyArIHRva2VuKTsKICAgIHJldHVybiBuZXcgUHJvbWlzZShmdW5jdGlvbiAocmVzb2x2ZSwgcmVqZWN0KSB7CiAgICAgIGF4aW9zLmdldCgnaHR0cDovLzEyNy4wLjAuMTo4MDAwL2FwaS91c2VyJykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICBjb250ZXh0LmNvbW1pdCgndXBkYXRlQ3VycmVudFVzZXInLCByZXNwb25zZURhdGEpOwogICAgICAgIHJlc29sdmUocmVzcG9uc2UpOwogICAgICB9KS5jYXRjaChmdW5jdGlvbiAoZXJyKSB7CiAgICAgICAgY29uc29sZS5sb2coZXJyLm1lc3NhZ2UpOwogICAgICAgIHJlamVjdChlcnIpOwogICAgICB9KTsKICAgIH0pOwogIH0sCiAgQVVUSF9SRUdJU1RFUjogZnVuY3Rpb24gQVVUSF9SRUdJU1RFUihjb250ZXh0LCB1c2VyKSB7CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBjb25zb2xlLmxvZygncmVnaXN0ZXJpbmcgdXNlci4uLicpOwogICAgICBheGlvcy5wb3N0KCdodHRwOi8vMTI3LjAuMC4xOjgwMDAvYXBpL3JlZ2lzdGVyJywgdXNlcikudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICB2YXIgcmVzcG9uc2VEYXRhID0gcmVzcG9uc2UuZGF0YTsKICAgICAgICB2YXIgbm93ID0gRGF0ZS5ub3coKTsKICAgICAgICByZXNwb25zZURhdGEuZXhwaXJlc19pbiA9IHJlc3BvbnNlRGF0YS5leHBpcmVzX2luICsgbm93OwogICAgICAgIGNvbnNvbGUubG9nKHJlc3BvbnNlRGF0YSk7CiAgICAgICAgY29udGV4dC5jb21taXQoJ3VwZGF0ZVRva2VucycsIHJlc3BvbnNlRGF0YS50b2tlbik7CiAgICAgICAgcmVzb2x2ZShyZXNwb25zZSk7CiAgICAgIH0pLmNhdGNoKGZ1bmN0aW9uIChlcnIpIHsKICAgICAgICByZWplY3QoZXJyKTsKICAgICAgfSk7CiAgICB9KTsKICB9LAogIEFVVEhfTE9HT1VUOiBmdW5jdGlvbiBBVVRIX0xPR09VVChfcmVmKSB7CiAgICB2YXIgY29tbWl0ID0gX3JlZi5jb21taXQ7CiAgICBjb25zb2xlLmxvZygnbG9nZ2luZyB1c2VyIG91dC4uLicpOwogICAgdmFyIHRva2VuID0gbG9jYWxTdG9yYWdlLmdldEl0ZW0oJ2FjY2Vzc190b2tlbicpOwogICAgY29uc29sZS5sb2coJ2FjY2Vzc190b2tlbicgKyB0b2tlbik7CiAgICBheGlvcy5kZWZhdWx0cy5oZWFkZXJzLmNvbW1vblsnQXV0aG9yaXphdGlvbiddID0gJ0JlYXJlciAnICsgdG9rZW47CiAgICByZXR1cm4gbmV3IFByb21pc2UoZnVuY3Rpb24gKHJlc29sdmUsIHJlamVjdCkgewogICAgICBheGlvcy5nZXQoJ2h0dHA6Ly8xMjcuMC4wLjE6ODAwMC9hcGkvbG9nb3V0JykudGhlbihmdW5jdGlvbiAocmVzcG9uc2UpIHsKICAgICAgICBsb2NhbFN0b3JhZ2UucmVtb3ZlSXRlbSgnYWNjZXNzX3Rva2VuJyk7CiAgICAgICAgY29uc29sZS5sb2coJ2xvZ291dCB1c2VyLi4uJyk7CiAgICAgICAgdmFyIHVzZXIgPSB7fTsKICAgICAgICBjb250ZXh0LmNvbW1pdCgndXBkYXRlQ3VycmVudFVzZXInLCB1c2VyKTsKICAgICAgICByZXNvbHZlKHJlc3BvbnNlKTsKICAgICAgfSkuY2F0Y2goZnVuY3Rpb24gKGVycm9yKSB7CiAgICAgICAgY29uc29sZS5sb2coJ2ZhaWwgdG8gbG9nb3V0IHVzZXIuLi4nKTsKICAgICAgICBjb25zb2xlLmxvZyhlcnJvcik7CiAgICAgICAgcmVqZWN0KGVycm9yKTsKICAgICAgfSk7CiAgICB9KTsKICB9Cn07CnZhciBtdXRhdGlvbnMgPSB7CiAgdXBkYXRlVG9rZW5zOiBmdW5jdGlvbiB1cGRhdGVUb2tlbnMoc3RhdGUsIHRva2VucykgewogICAgc3RhdGUudG9rZW5zID0gdG9rZW5zOwogIH0sCiAgdXBkYXRlQ3VycmVudFVzZXI6IGZ1bmN0aW9uIHVwZGF0ZUN1cnJlbnRVc2VyKHN0YXRlLCBjdXJyZW50VXNlcikgewogICAgc3RhdGUuY3VycmVudFVzZXIgPSBjdXJyZW50VXNlcjsKICB9Cn07CnZhciBnZXR0ZXJzID0gewogIGdldEFjY2Vzc1Rva2VuOiBmdW5jdGlvbiBnZXRBY2Nlc3NUb2tlbihzdGF0ZSkgewogICAgcmV0dXJuIHN0YXRlLnRva2Vucy5hY2Nlc3NfdG9rZW47CiAgfSwKICBnZXRDdXJyZW50VXNlcjogZnVuY3Rpb24gZ2V0Q3VycmVudFVzZXIoc3RhdGUpIHsKICAgIHJldHVybiBzdGF0ZS5jdXJyZW50VXNlcjsKICB9Cn07CmV4cG9ydCBkZWZhdWx0IHsKICBzdGF0ZTogc3RhdGUsCiAgZ2V0dGVyczogZ2V0dGVycywKICBhY3Rpb25zOiBhY3Rpb25zLAogIG11dGF0aW9uczogbXV0YXRpb25zCn07"},{"version":3,"sources":["/home/lionel/Projects/vue_app/surkeys_website/src/store/modules/user.js"],"names":["axios","api","state","tokens","access_token","expires_in","refresh_token","token_type","currentUser","actions","login","context","user","Promise","resolve","reject","data","email","password","console","log","post","then","response","responseData","now","Date","commit","token","localStorage","setItem","catch","err","getCurrentUser","getItem","defaults","headers","common","get","message","AUTH_REGISTER","AUTH_LOGOUT","removeItem","error","mutations","updateTokens","updateCurrentUser","getters","getAccessToken"],"mappings":"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","sourcesContent":["\nimport axios from \"axios\";\nimport api from '../../api/service.js'\n\nconst state = {\n  tokens: {\n    access_token: null,\n    expires_in: null,\n    refresh_token: null,\n    token_type: null\n  },\n  currentUser: {}\n}\n\n\nconst actions = {\n  login( context, user) {\n     return new Promise((resolve, reject) => {\n\n        let data = {\n          // client_id: 2,\n          // client_secret: 'dOjwKuRQ9DZBSfqVgaIOv5jIWagzQ3iNJj73lTCz',\n          // grant_type: 'password',\n          email: user.email,\n          password: user.password,\n        };\n\n         console.log(data)\n         axios.post('http://127.0.0.1:8000/api/login', data)\n          .then(response => {\n            let responseData = response.data\n            let now = Date.now()\n\n            responseData.expires_in = responseData.expires_in + now\n\n            console.log(responseData)\n\n            context.commit('updateTokens', responseData.token)\n            localStorage.setItem('access_token', responseData.token )\n\n            resolve(response)\n          }).catch( err => { reject(err)})\n     })\n  },\n  getCurrentUser(context) {\n    \n     console.log('getting current user...')\n     let token = localStorage.getItem('access_token')\n\n     axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n    \n    console.log('access_item'+ token)\n    return new Promise((resolve, reject) => {\n      axios.get('http://127.0.0.1:8000/api/user')\n        .then (response => {\n          let responseData = response.data\n          context.commit('updateCurrentUser', responseData)\n          resolve(response)\n        }).catch( err => { \n          console.log(err.message)\n          reject(err)\n        })\n    })\n  },\n  AUTH_REGISTER(context, user) {\n\n    return new Promise((resolve, reject) => {\n       console.log('registering user...')\n       axios.post('http://127.0.0.1:8000/api/register', user)\n      .then(response => {\n          let responseData = response.data\n          let now = Date.now()\n\n          responseData.expires_in = responseData.expires_in + now\n\n          console.log(responseData)\n          context.commit('updateTokens', responseData.token)\n\n          resolve(response)\n        }).catch( err => { reject(err)})\n     })\n  },\n  AUTH_LOGOUT({commit}){\n    console.log('logging user out...')\n     let token = localStorage.getItem('access_token')\n     console.log('access_token'+ token)\n     axios.defaults.headers.common['Authorization'] = 'Bearer ' + token;\n\n    return new Promise(( resolve, reject) => {\n        axios.get('http://127.0.0.1:8000/api/logout')\n          .then( response => {\n            localStorage.removeItem('access_token')\n            console.log('logout user...')\n             let user = {}\n             context.commit('updateCurrentUser', user)\n            resolve(response)\n          }).catch( error => {\n            console.log('fail to logout user...')\n            console.log(error)\n            reject(error)\n          })\n    });\n  }\n}\n\n\nconst mutations = {\n    updateTokens(state, tokens) {\n      state.tokens = tokens\n    },\n    updateCurrentUser(state, currentUser) {\n      state.currentUser = currentUser\n    },\n}\n\nconst getters = {\n    getAccessToken(state) {\n      return state.tokens.access_token\n    },\n    getCurrentUser(state) {\n      return state.currentUser\n    },\n}\n\nexport default {\n  state,\n  getters,\n  actions,\n  mutations\n}"]}]}